<%= form_for(@prescri) do |f| %>
  <% if @prescri.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@prescri.errors.count, "error") %> prohibited this prescri from being saved:</h2>

      <ul>
      <% @prescri.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <div class="field">
    <%= f.label "患者姓名:" %>
    <%= f.text_field :patient_name %>
  </div>
  <div class="field">
    <%= f.label "患者性别:" %>
    <%= f.select :gender,['男','女'] %>
  </div>
  <div class="field">
    <%= f.label "患者年龄:" %>
    <%= f.number_field :age %>
  </div>
  <div class="field">
    <%= f.label "就诊科室:" %>
    <%= f.text_field :departments %>
  </div>
  <div class="field">
    <%= f.label "临床诊断:" %>
    <%= f.text_field :diagnose %>
  </div>
  <div class="field">
    <%= f.label "就诊时间:" %>
    <%= f.text_field :created_at,value: @prescri.created_at || Time.now %>
  </div>
  <legend>药品</legend>
  <table class="table">
    <thead> 
      <th>药品名称</th>
      <th>药品单价</th>
      <th>药品数量</th>
      <th>药品总价</th>      
    </thead>
    <tr>
      <td><%= f.select :drug1,Drug.all.collect {|p| [ p.name, p.id ] }, { include_blank:true },{ class: 'chosen-select' } %></td>
      <td id="drug1_price"></td>
      <td><%= f.number_field :amount1%></td>
      <td id="drug1_total_price"></td>
    </tr>
    <tr>
      <td><%= f.select :drug2,Drug.all.collect {|p| [ p.name, p.id ] }, { include_blank:true } %></td>
      <td id="drug2_price"></td>
      <td><%= f.number_field :amount2%></td>
      <td id="drug2_total_price"></td>
    </tr>
    <tr>
      <td><%= f.select :drug3,Drug.all.collect {|p| [ p.name, p.id ] }, { include_blank:true } %></td>
      <td id="drug3_price"></td>
      <td><%= f.number_field :amount3%></td>
      <td id="drug3_total_price"></td>
    </tr>
    <tr>
      <td><%= f.select :drug4,Drug.all.collect {|p| [ p.name, p.id ] }, { include_blank:true } %></td>
      <td id="drug4_price"></td>
      <td><%= f.number_field :amount4%></td>
      <td id="drug4_total_price"></td>
    </tr>
  </table>
  <div class="field">
  <%= f.label "药品费用:" %>
    <%= f.text_field :total_price,readonly: true %>
  </div>
  <div class="actions">
    <%= f.submit "生成处方",class: 'btn' %>
  </div>
<% end %>
